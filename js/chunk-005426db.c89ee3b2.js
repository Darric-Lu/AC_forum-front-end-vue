(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-005426db"],{6135:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container py-5"},[n("AdminNav"),n("table",{staticClass:"table"},[t.isLoading?n("Spinner"):[n("thead",{staticClass:"thead-dark"},[n("tr",[n("th",{attrs:{scope:"col"}},[t._v("#")]),n("th",{attrs:{scope:"col"}},[t._v("Email")]),n("th",{attrs:{scope:"col"}},[t._v("Role")]),n("th",{attrs:{scope:"col",width:"140"}},[t._v("Action")])])]),n("tbody",t._l(t.users,(function(e){return n("tr",{key:e.id},[n("th",{attrs:{scope:"row"}},[t._v(t._s(e.id))]),n("td",[t._v(t._s(e.email))]),n("td",[e.isAdmin?n("span",[t._v("admin")]):n("span",[t._v("user")])]),n("td",[e.mainAdmin?t._e():n("div",[e.isAdmin?n("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.toggleUserRole(e.id)}}},[t._v(" set as user ")]):n("button",{staticClass:"btn btn-link",attrs:{type:"button"},on:{click:function(n){return n.stopPropagation(),n.preventDefault(),t.toggleUserRole(e.id)}}},[t._v(" set as admin ")])])])])})),0)]],2)],1)},a=[],i=n("1da1"),s=n("5530"),u=(n("96cf"),n("d81d"),n("7db0"),n("2f62")),c=n("2fa3"),o=n("be6c"),d=n("e04c"),l=n("2375"),f={name:"AdminUsers",components:{AdminNav:d["a"],Spinner:l["a"]},data:function(){return{users:[],isLoading:!0}},computed:Object(s["a"])({},Object(u["b"])(["currentUser"])),created:function(){this.fetchUser(),this.judgeMainAdmin()},methods:{fetchUser:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o["a"].user.get();case 3:n=e.sent,r=n.data,t.users=r.users.map((function(t){return Object(s["a"])({},t)})),t.judgeMainAdmin(),t.isLoading=!1,e.next=14;break;case 10:e.prev=10,e.t0=e["catch"](0),t.isLoading=!1,c["a"].fire({icon:"erorr",title:"無法讀取資料"});case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))()},toggleUserRole:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r=JSON.stringify({isAdmin:String(!e.users.find((function(e){return e.id===t})).isAdmin)}),n.prev=1,n.next=4,o["a"].user.update({userId:t,authority:r});case 4:a=n.sent,a.data,e.users=e.users.map((function(e){return e.id===t?Object(s["a"])(Object(s["a"])({},e),{},{isAdmin:!e.isAdmin}):e})),n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](1),c["a"].fire({icon:"error",title:"目前沒有權限"});case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))()},judgeMainAdmin:function(){var t=this.currentUser.id;this.users=this.users.map((function(e){return e.id===t||1===e.id?Object(s["a"])(Object(s["a"])({},e),{},{mainAdmin:!0}):e}))}},watch:{currentUser:function(){this.judgeMainAdmin()}}},m=f,p=n("2877"),v=Object(p["a"])(m,r,a,!1,null,null,null);e["default"]=v.exports},"7db0":function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").find,i=n("44d2"),s="find",u=!0;s in[]&&Array(1)[s]((function(){u=!1})),r({target:"Array",proto:!0,forced:u},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),i(s)},be6c:function(t,e,n){"use strict";n("b0c0");var r=n("2fa3");e["a"]={categories:{get:function(){return r["b"].get("admin/categories")},create:function(t){return r["b"].post("admin/categories",{name:t})},update:function(t){var e=t.id,n=t.name;return r["b"].put("admin/categories/".concat(e),{name:n})},delete:function(t){return r["b"].delete("/admin/categories/".concat(t))}},restaurant:{getDetail:function(t){var e=t.restaurantId;return r["b"].get("/admin/restaurants/".concat(e))},create:function(t){var e=t.formData;return r["b"].post("/admin/restaurants",e)},get:function(){return r["b"].get("/admin/restaurants")},delete:function(t){return r["b"].delete("/admin/restaurants/".concat(t))},update:function(t){var e=t.restaurantId,n=t.formData;return r["b"].put("/admin/restaurants/".concat(e),n)}},user:{get:function(){return r["b"].get("/admin/users")},update:function(t){var e=t.userId,n=t.authority;return r["b"].put("/admin/users/".concat(e),n,{headers:{"Content-Type":"application/json;charset=UTF-8"}})}}}},d81d:function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").map,i=n("1dde"),s=i("map");r({target:"Array",proto:!0,forced:!s},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},e04c:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mb-3"},[n("h1",[t._v("餐廳後台")]),n("router-link",{attrs:{to:"/admin/restaurants"}},[t._v(" Restaurants")]),t._v(" | "),n("router-link",{attrs:{to:"/admin/categories"}},[t._v("Categories")]),t._v(" | "),n("router-link",{attrs:{to:"/admin/users"}},[t._v("Users")])],1)},a=[],i=n("2877"),s={},u=Object(i["a"])(s,r,a,!1,null,null,null);e["a"]=u.exports}}]);
//# sourceMappingURL=chunk-005426db.c89ee3b2.js.map